#! /bin/sh

set -e

case "$1" in

	-h|--help)

		echo "${0##*/}: Print the executable files found in a script."
		echo "Usage: ${0##*/} [-h|--help] <binary>"
		exit

	;;

esac

_e () { echo -e "${0##*/}: \e[31mError:\e[0m $@" >&2; exit 1; }


# -- Binaries match the following rules:
# -- They are the first word in a line.
# -- They come after a "`" character.
# -- They come after a "|" character.
# -- They come after a "$(" construct.
# -- Their names start with "/", "./" or "../".

sed '
	/^#/d
	/^$/d
	s:(:\n:g
	s:{:\n:g
	s:`:\n:g
	s:|:\n:g
	s:&:\n:g
	s:;:\n:g
' $@ |
sort |
awk '{ print $1 }' |
uniq |
while read file; do

	{

		type $file | grep -q \
			-e builtin \
			-e keyword \
			-e function \
			-e alias \
		&&
			continue

		which -- $file

	} || :

done 2> /dev/null
