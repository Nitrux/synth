#! /bin/sh

set -e

case "$1" in

	-h|--help)

		echo "${0##*/}: Print the commands called by a UNIX shell script."
		echo "Usage: ${0##*/} [-h|--help] <script>"
		exit

	;;

esac

_e () { echo -e "${0##*/}: \e[31mError:\e[0m $@" >&2; exit 1; }




#		Functions.

_list_cmds () {
	sed \
		-e '/^#/d' \
		-e '/^$/d' \
		-e 's:^[ \t]*::' \
		-e 's:(:\n:g' \
		-e 's:{:\n:g' \
		-e 's:`:\n:g' \
		-e 's:|:\n:g' \
		-e 's:&:\n:g' \
		-e 's:;:\n:g' \
		"$@"
}


_get_path () {
	while read f; do
		which -- "$f" && continue
		test -f "$f" && echo "$f" || true
	done 2> /dev/null
}


_list_cmds "$@" |
cut -d ' ' -f 1 |
sort -u         |
_get_path
